[["manejo-de-florestas-plantadas.html", "4 Manejo de Florestas Plantadas 4.1 Altura Dominante", " 4 Manejo de Florestas Plantadas 4.1 Altura Dominante A altura dominante, que representa a média das alturas das árvores mais altas e/ou mais grossas de um determinado número de árvores por hectare, é menos influenciada por variações de densidade e competições locais entre árvores menores, tornando-a uma medida confiável da qualidade do sítio. Com ela, é possível estimar o potencial de crescimento da floresta, modelar curvas de crescimento e projetar a produção futura, auxiliando no planejamento sustentável e na tomada de decisões estratégicas no manejo florestal. Dados exemplo: Baixar dados A.Parc. Parc n DAP Ht Hdom 720 711 1 19.74 14.65 NA 720 711 2 NA NA NA 720 711 3 19.19 14.44 NA 720 711 4 17.83 13.89 NA 720 711 5 18.46 14.15 NA 720 711 6 20.05 14.78 NA 4.1.1 Calculando altura dominante por parcela (Assman) BD &lt;- read.csv2(&quot;data/DesafioCalcHdom.csv&quot;) colnames(BD)[1] = c(&quot;areaParc&quot;) BD &lt;- BD[, 1:5] BD &lt;- BD[order(BD$Parc, BD$DAP, decreasing = TRUE),] row.names(BD) &lt;- NULL Parc &lt;- unique(BD$Parc) Hdom_assman &lt;- unique(BD$Parc) j &lt;- 1 for (i in Parc) { a &lt;- ceiling(mean(BD[which(BD$Parc==i),1])*100/10000) H &lt;- BD[which(BD$Parc==i),5] Hdom_assman[j] &lt;- round(mean(H[1:a]), 2) j &lt;- j+1 } BD2 &lt;- as.data.frame(cbind(Parc, Hdom_assman)) BD &lt;- merge(BD, BD2) Resultado: Parc Hdom_assman 711 14.56 623 13.99 622 13.49 621 14.60 534 14.98 533 14.59 532 14.74 531 14.93 453 14.49 452 14.50 451 14.50 344 15.04 343 14.44 342 14.76 341 14.92 262 13.25 261 14.30 173 14.10 172 14.22 171 14.80 4.1.1.1 Exercício Faça o cálculo da altura dominante agora seguindo o conceito de Hart: 100 árvores mais altas por hectare. Mostrar solução Solução do problema sem o pipe BD &lt;- read.csv2(&quot;data/DesafioCalcHdom.csv&quot;) colnames(BD)[1] = c(&quot;areaParc&quot;) BD &lt;- BD[, 1:5] BD &lt;- BD[order(BD$Parc, BD$Ht, decreasing = TRUE),] row.names(BD) &lt;- NULL Parc &lt;- unique(BD$Parc) Hdom_hart &lt;- unique(BD$Parc) j &lt;- 1 for (i in Parc) { a &lt;- ceiling(mean(BD[which(BD$Parc==i),1])*100/10000) H &lt;- BD[which(BD$Parc==i),5] Hdom_hart[j] &lt;- round(mean(H[1:a]), 2) j &lt;- j+1 } BD2 &lt;- as.data.frame(cbind(Parc, Hdom_hart)) BD &lt;- merge(BD, BD2) Resultado: Parc Hdom_hart 711 14.56 623 13.99 622 13.49 621 14.60 534 14.98 533 14.59 532 14.74 531 14.93 453 14.49 452 14.50 451 14.50 344 15.04 343 14.44 342 14.76 341 14.92 262 13.25 261 14.30 173 14.10 172 14.22 171 14.80 Solução com pipe library(dplyr) BD &lt;- BD %&gt;% arrange(Parc, desc(Ht)) # Garantir a ordem correta BD_Hart &lt;- BD %&gt;% group_by(Parc) %&gt;% mutate( num_top = ceiling(mean(areaParc) * 100 / 10000) ) %&gt;% slice(1:first(num_top)) %&gt;% summarise( Hdom_Hart2 = round(mean(Ht, na.rm = TRUE), 2) ) %&gt;% ungroup() BD_HDOM &lt;- merge(BD2, BD_Hart, by = &quot;Parc&quot;) Resultado: Parc Hdom_hart Hdom_Hart2 171 14.80 14.80 172 14.22 14.22 173 14.10 14.10 261 14.30 14.30 262 13.25 13.25 341 14.92 14.92 342 14.76 14.76 343 14.44 14.44 344 15.04 15.04 451 14.50 14.50 452 14.50 14.50 453 14.49 14.49 531 14.93 14.93 532 14.74 14.74 533 14.59 14.59 534 14.98 14.98 621 14.60 14.60 622 13.49 13.49 623 13.99 13.99 711 14.56 14.56 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
