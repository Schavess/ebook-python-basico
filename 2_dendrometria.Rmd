# Dendrometria

Como mostrado em [@verly2020], o R facilita a análise de dados.

## Diâmetros

### Histogramas de distribuição diamétrica
Este tipo de abordagem é útil para se verificar o grau de aproximação da Normalidade dos dados pela "formato" das classes através da frequência de indivíduos por classe diamétrica.

Os engenheiros florestais geralmente estabelecem classes diamétricas em intervalos fixos de 1,5 ou 2,0 cm para poderem comparar entre si as inúmeras parcelas; bem como para acompanhar a mudança de classe das árvores ao longo do tempo.

#### Criando dados para demonstração

```{r}
# Definir número de árvores por parcela
n_arvores <- 50

# Gerar dados de 3 parcelas com diâmetros distribuídos normalmente
set.seed(123)  # Para garantir reprodutibilidade

parcela1 <- rnorm(n_arvores, mean = 25, sd = 5)  # Parcela 1 com média 25 cm e desvio padrão 5 cm
parcela2 <- rnorm(n_arvores, mean = 30, sd = 7)  # Parcela 2 com média 30 cm e desvio padrão 7 cm
parcela3 <- rnorm(n_arvores, mean = 35, sd = 6)  # Parcela 3 com média 35 cm e desvio padrão 6 cm

# Criar um data frame com os dados das parcelas
dados_inventario <- data.frame(
  Parcela = rep(c("1", "2", "3"), each = n_arvores),
  Diametro = c(parcela1, parcela2, parcela3)
)
```

#### Construindo os histogramas

```{r}
# Definir as classes diamétricas com intervalo de 2 cm
intervalo <- 2
min_diametro <- floor(min(dados_inventario$Diametro))  # Valor mínimo de diâmetro arredondado para baixo
max_diametro <- ceiling(max(dados_inventario$Diametro))  # Valor máximo de diâmetro arredondado para cima
intervalos <- seq(min_diametro - intervalo, max_diametro + intervalo, by = intervalo)  # Definir as classes com intervalo de 2 cm

# Criar layout para os gráficos
par(mfrow = c(1, 3))  # Define 3 gráficos em uma linha

# Definir lista de parcelas
parcelas <- unique(dados_inventario$Parcela)

# Loop para plotar histogramas de cada parcela
for (parcela in parcelas) {
  # Selecionar os dados da parcela atual
  dados_parcela <- dados_inventario[dados_inventario$Parcela == parcela, "Diametro"]
  # Plotar o histograma
  hist(dados_parcela,
       breaks = intervalos,
       main = paste("Histograma - parcela ", parcela),
       xlab = "Diâmetro (cm)", 
       ylab = "Frequência",
       ylim = c(0, 10),
       col = "skyblue",
       border = "black")
}
```

## Alturas

### Altura Dominante

A altura dominante, que representa a média das alturas das árvores mais altas e/ou mais grossas de um determinado número de árvores por hectare, é menos influenciada por variações de densidade e competições locais entre árvores menores, tornando-a uma medida confiável da qualidade do sítio. Com ela, é possível estimar o potencial de crescimento da floresta, modelar curvas de crescimento e projetar a produção futura, auxiliando no planejamento sustentável e na tomada de decisões estratégicas no manejo florestal.

<br>

Dados exemplo:
[Baixar dados](data/DesafioCalcHdom.csv)

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#install.packages("kableExtra")

BD <- read.csv2("data/DesafioCalcHdom.csv")

library(kableExtra)

# Exibir o data.frame com formatação extra
head(BD) %>%
  knitr::kable() %>%
  kableExtra::kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover"))
```

#### Calculando altura dominante por parcela (Assman)
```{r}
BD <- read.csv2("data/DesafioCalcHdom.csv")
colnames(BD)[1] = c("areaParc")
BD <- BD[, 1:5]
BD <- BD[order(BD$Parc, BD$Ht, decreasing = TRUE),]
row.names(BD) <- NULL

Parc <- unique(BD$Parc)
Hdom <- unique(BD$Parc)

j <- 1
for (i in Parc) {
  a <- round(mean(BD[which(BD$Parc==i),1])*100/10000, 0)
  H <- BD[which(BD$Parc==i),5]
  Hdom[j] <- round(mean(H[1:a]), 2)
  j <- j+1
}

BD2 <- as.data.frame(cbind(Parc, Hdom))
BD <- merge(BD, BD2)

rm(a, H, Hdom, i, j, Parc)

```
<br>
Resultado:
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)

# Exibir o data.frame com formatação extra
BD2 %>%
  knitr::kable() %>%
  kableExtra::kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover"))
```